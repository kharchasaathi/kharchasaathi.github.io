<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login ‚Äî KharchaSaathi</title>

  <style>
    body{
      font-family:Arial, sans-serif;
      background:#f1f1f1;
      padding:22px;
    }
    .card{
      max-width:450px;
      margin:40px auto;
      background:#fff;
      padding:28px;
      border-radius:12px;
      border:2px solid #ddd;
      box-shadow:0 8px 25px rgba(0,0,0,0.1);
    }
    input{
      width:100%;
      padding:12px;
      margin:10px 0;
      border-radius:8px;
      border:2px solid #ccc;
      font-size:15px;
    }
    .pw-wrapper{
      position:relative;
    }
    .pw-eye{
      position:absolute;
      right:14px;
      top:50%;
      transform:translateY(-50%);
      font-size:18px;
      cursor:pointer;
      color:#777;
    }
    button{
      padding:12px;
      width:100%;
      border:none;
      font-size:16px;
      background:#ff7a00;
      color:#fff;
      border-radius:8px;
      cursor:pointer;
      margin-top:10px;
    }
    button:hover{
      background:#e56d00;
    }
    .muted{
      margin-top:10px;
      font-size:13px;
      color:#666;
      text-align:center;
    }
    a{
      color:#ff7a00;
      text-decoration:none;
    }
  </style>
</head>

<body>

  <div class="card">
    <h2>Login</h2>

    <input id="email" type="email" placeholder="Email">

    <div class="pw-wrapper">
      <input id="password" type="password" placeholder="Password">
      <span class="pw-eye" id="togglePw">üëÅÔ∏è</span>
    </div>

    <button id="loginBtn">Login</button>

    <div id="msg" class="muted"></div>

    <div class="muted">
      Don't have an account? <a href="/signup.html">Sign Up</a>
    </div>
  </div>

  <!-- FIREBASE -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth-compat.js"></script>
  <script src="/js/firebase.js"></script>

  <script>
    const qs = s => document.querySelector(s);

    qs("#togglePw").addEventListener("click", () => {
      const pw = qs("#password");
      pw.type = pw.type === "password" ? "text" : "password";
    });

    qs("#loginBtn").addEventListener("click", async () => {
      const email = qs("#email").value.trim();
      const pw = qs("#password").value.trim();

      if(!email || !pw){
        qs("#msg").textContent = "Enter login details";
        return;
      }

      try {
        await window.fsLogin(email, pw);
        localStorage.setItem("ks-user-email", email);
        window.location.href = "/business.html";
      } catch (e) {
        qs("#msg").textContent = "Login failed: " + e.message;
        console.error(e);
      }
    });
  </script>

</body>
</html>
