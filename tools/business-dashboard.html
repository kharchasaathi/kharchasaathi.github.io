<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ“¦ Business Dashboard â€” KharchaSaathi</title>
<style>
  :root {
    --orange: #ff7a00;
    --orange-dark: #cc6300;
    --bg-light: #f8f9fa;
    --bg-dark: #121212;
    --card-light: #ffffff;
    --card-dark: #1e1e1e;
    --text-dark: #222;
    --text-light: #e8e8e8;
    --border-light: #ddd;
    --border-dark: #333;
  }

  body {
    font-family: "Poppins", Arial, sans-serif;
    background: var(--bg-light);
    margin: 0;
    padding: 20px;
    color: var(--text-dark);
    transition: background 0.3s, color 0.3s;
  }

  body.dark {
    background: var(--bg-dark);
    color: var(--text-light);
  }

  h2 {
    text-align: center;
    color: var(--orange);
  }

  .theme-toggle {
    position: fixed;
    top: 14px;
    right: 14px;
    background: var(--orange);
    color: white;
    border: none;
    border-radius: 6px;
    padding: 8px 12px;
    cursor: pointer;
    transition: 0.3s;
  }

  .theme-toggle:hover {
    background: var(--orange-dark);
  }

  .tabs {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 20px 0;
  }

  .tab {
    background: #ddd;
    padding: 10px 18px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: 0.3s;
  }

  body.dark .tab {
    background: #333;
    color: var(--text-light);
  }

  .tab.active {
    background: var(--orange);
    color: white;
  }

  .section {
    display: none;
    background: var(--card-light);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transition: 0.3s;
  }

  body.dark .section {
    background: var(--card-dark);
    box-shadow: 0 2px 8px rgba(255,255,255,0.05);
  }

  .section.active {
    display: block;
  }

  input, button, select {
    padding: 8px;
    margin: 6px;
    border-radius: 6px;
    border: 1px solid var(--border-light);
    background: inherit;
    color: inherit;
  }

  body.dark input, body.dark select {
    border: 1px solid var(--border-dark);
    background: #2b2b2b;
    color: var(--text-light);
  }

  button {
    background: var(--orange);
    color: white;
    border: none;
    cursor: pointer;
  }

  button:hover {
    background: var(--orange-dark);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }

  th, td {
    border: 1px solid var(--border-light);
    padding: 8px;
    text-align: center;
  }

  body.dark th, body.dark td {
    border: 1px solid var(--border-dark);
  }

  th {
    background: var(--orange);
    color: white;
  }

  .clear-btn {
    background: #d9534f;
  }

  .clear-btn:hover {
    background: #b52b27;
  }

  .remove-btn, .restock-btn {
    border-radius: 5px;
    padding: 5px 10px;
    color: white;
  }

  .remove-btn {
    background: #dc3545;
  }

  .remove-btn:hover {
    background: #a71d2a;
  }

  .restock-btn {
    background: #28a745;
  }

  .restock-btn:hover {
    background: #1e7e34;
  }

  a.back-link {
    background: #444;
    color: #fff;
    padding: 10px 18px;
    border-radius: 8px;
    text-decoration: none;
    display: inline-block;
    margin-top: 20px;
  }

  a.back-link:hover {
    background: #222;
  }

  body.dark a.back-link {
    background: #222;
  }

</style>
</head>
<body>

<button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>

<h2>ğŸ“¦ Business Dashboard</h2>

<div class="tabs">
  <div class="tab active" onclick="openTab('types')">ğŸ—‚ Manage Types</div>
  <div class="tab" onclick="openTab('stock')">ğŸ“¦ Current Stock</div>
  <div class="tab" onclick="openTab('sales')">ğŸ“ˆ Sales Ledger</div>
  <div class="tab" onclick="openTab('wanting')">ğŸ›’ Wanting List</div>
</div>

<!-- TYPES SECTION -->
<div id="types" class="section active">
  <h3>ğŸ—‚ Manage Item Types</h3>
  <input id="typeName" placeholder="Enter new type (e.g. Mobiles, Grocery, Accessories)">
  <button onclick="addType()">Add Type</button>
  <button class="clear-btn" onclick="clearTypes()">ğŸ§¹ Clear All Types</button>

  <h4>ğŸ“‹ Available Types</h4>
  <ul id="typeList"></ul>
</div>

<!-- STOCK SECTION -->
<div id="stock" class="section">
  <h3>ğŸ§¾ Current Stock</h3>
  <table id="stockTable">
    <thead>
      <tr><th>Date</th><th>Type</th><th>Product</th><th>Qty</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <h4>Add New Stock</h4>
  <input id="pdate" type="date">
  <select id="ptype"></select>
  <input id="pname" placeholder="Product name">
  <input id="pqty" type="number" placeholder="Quantity">
  <button onclick="addStock()">Add</button>
  <button class="clear-btn" onclick="clearStock()">ğŸ§¹ Clear Stock</button>
</div>

<!-- SALES SECTION -->
<div id="sales" class="section">
  <h3>ğŸ’° Sales Ledger</h3>
  <table id="salesTable">
    <thead>
      <tr><th>Date</th><th>Type</th><th>Product</th><th>Qty</th><th>Price â‚¹</th><th>Total â‚¹</th></tr>
    </thead>
    <tbody></tbody>
  </table>
  <button class="clear-btn" onclick="clearSales()">ğŸ§¹ Clear All Sales</button>
</div>

<!-- WANTING SECTION -->
<div id="wanting" class="section">
  <h3>ğŸ›’ Wanting Items</h3>
  <table id="wantTable">
    <thead>
      <tr><th>Date</th><th>Type</th><th>Item</th><th>Restocked Qty</th><th>Actions</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <h4>Add Wanting Item</h4>
  <input id="wdate" type="date">
  <select id="wtype"></select>
  <input id="witem" placeholder="Item name">
  <button onclick="addWant()">Add</button>
  <button class="clear-btn" onclick="clearWant()">ğŸ§¹ Clear Entire List</button>
</div>

<div style="text-align:center;">
  <a href="../index.html" class="back-link">â† Back to Home</a>
</div>

<script>
let types = JSON.parse(localStorage.getItem('item-types')||'[]');
let stock = JSON.parse(localStorage.getItem('stock-data')||'[]');
let sales = JSON.parse(localStorage.getItem('sales-data')||'[]');
let want = JSON.parse(localStorage.getItem('wanting-data')||'[]');

// Theme
(function(){
  const theme = localStorage.getItem('ks-theme');
  if(theme === 'dark'){
    document.body.classList.add('dark');
    document.querySelector('.theme-toggle').textContent = 'â˜€ï¸';
  }
})();
function toggleTheme(){
  const isDark = document.body.classList.toggle('dark');
  localStorage.setItem('ks-theme', isDark ? 'dark' : 'light');
  document.querySelector('.theme-toggle').textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
}

// Tabs
function openTab(tab) {
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.querySelector(`[onclick="openTab('${tab}')"]`).classList.add('active');
  document.getElementById(tab).classList.add('active');
}

// Type Management
function addType(){
  const name=document.getElementById('typeName').value.trim();
  if(!name) return alert("Enter type name!");
  if(types.includes(name)) return alert("Type already exists!");
  types.push(name);
  localStorage.setItem('item-types',JSON.stringify(types));
  renderTypes(); updateDropdowns();
  document.getElementById('typeName').value='';
}
function clearTypes(){
  if(confirm("Clear all types?")){
    localStorage.removeItem('item-types');
    types=[]; renderTypes(); updateDropdowns();
  }
}
function renderTypes(){
  const ul=document.getElementById('typeList');
  ul.innerHTML=types.length?types.map(t=>`<li>${t}</li>`).join(''):"<li>No types added yet.</li>";
}
function updateDropdowns(){
  const selects=[document.getElementById('ptype'),document.getElementById('wtype')];
  selects.forEach(sel=>{
    sel.innerHTML='<option value="">Select Type</option>' + types.map(t=>`<option>${t}</option>`).join('');
  });
}

// Stock
function addStock(){
  let type=document.getElementById('ptype').value;
  let name=document.getElementById('pname').value.trim();
  let qty=parseInt(document.getElementById('pqty').value);
  let date=document.getElementById('pdate').value;
  if(!type||!name||!qty||!date) return alert("Fill all fields!");
  stock.push({type,name,qty,date});
  localStorage.setItem('stock-data',JSON.stringify(stock));
  renderStock();
  document.getElementById('pname').value='';
  document.getElementById('pqty').value='';
}
function clearStock(){ if(confirm("Clear all stock?")){localStorage.removeItem('stock-data');stock=[];renderStock();}}

// Wanting
function addWant(){
  let type=document.getElementById('wtype').value;
  let item=document.getElementById('witem').value.trim();
  let date=document.getElementById('wdate').value;
  if(!type||!item||!date) return alert("Fill all fields!");
  want.push({type,item,date});
  localStorage.setItem('wanting-data',JSON.stringify(want));
  renderWant();
  document.getElementById('witem').value='';
}
function removeWant(i){ if(confirm("Remove this item?")){ want.splice(i,1); localStorage.setItem('wanting-data',JSON.stringify(want)); renderWant(); } }
function restockFromWant(i){
  let qty=prompt("Enter restocked quantity:");
  if(!qty || isNaN(qty)) return;
  const today=new Date().toISOString().split('T')[0];
  const item=want[i];
  stock.push({type:item.type,name:item.item,qty:parseInt(qty),date:today});
  localStorage.setItem('stock-data',JSON.stringify(stock));
  want.splice(i,1);
  localStorage.setItem('wanting-data',JSON.stringify(want));
  renderStock(); renderWant();
}
function clearWant(){ if(confirm("Clear wanting list?")){localStorage.removeItem('wanting-data');want=[];renderWant();}}

// Render
function renderStock(){
  const tb=document.querySelector('#stockTable tbody');
  tb.innerHTML=stock.length?stock.map(s=>`<tr><td>${s.date}</td><td>${s.type}</td><td>${s.name}</td><td>${s.qty}</td></tr>`).join(''):"<tr><td colspan=4>No stock available.</td></tr>";
}
function renderWant(){
  const tb=document.querySelector('#wantTable tbody');
  if(!want.length){tb.innerHTML="<tr><td colspan=5>No wanting items.</td></tr>";return;}
  let grouped={};
  want.forEach(w=>{
    if(!grouped[w.type]) grouped[w.type]=[];
    grouped[w.type].push(w);
  });
  tb.innerHTML=Object.entries(grouped).map(([type,items])=>`
    <tr><th colspan="5" style="background:#ffe0b3;">${type}</th></tr>
    ${items.map((w,i)=>`<tr><td>${w.date}</td><td>${w.type}</td><td>${w.item}</td>
      <td>-</td>
      <td>
        <button class='restock-btn' onclick='restockFromWant(${want.indexOf(w)})'>âœ” Restocked</button>
        <button class='remove-btn' onclick='removeWant(${want.indexOf(w)})'>ğŸ—‘ Remove</button>
      </td>
    </tr>`).join('')}
  `).join('');
}
function renderSales(){
  const tb=document.querySelector('#salesTable tbody');
  tb.innerHTML=sales.length?sales.map(s=>`<tr><td>${s.date}</td><td>${s.type||'-'}</td><td>${s.product}</td><td>${s.qty}</td><td>${s.price||'-'}</td><td>${(s.amount||0).toFixed(2)}</td></tr>`).join(''):"<tr><td colspan=6>No sales yet.</td></tr>";
}
function clearSales(){ if(confirm("Clear all sales?")){localStorage.removeItem('sales-data');sales=[];renderSales();}}

// Initial
renderTypes(); updateDropdowns(); renderStock(); renderSales(); renderWant();
</script>
</body>
</html>
