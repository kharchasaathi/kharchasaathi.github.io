<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üì¶ Business Dashboard ‚Äî KharchaSaathi</title>
<style>
:root {
  --orange: #ff7a00;
  --orange-dark: #cc6300;
  --bg-light: #f8f9fa;
  --bg-dark: #121212;
  --card-light: #ffffff;
  --card-dark: #1e1e1e;
  --text-dark: #222;
  --text-light: #e8e8e8;
  --border-light: #ddd;
  --border-dark: #333;
}

body {
  font-family: "Poppins", Arial, sans-serif;
  background: var(--bg-light);
  margin: 0;
  padding: 20px;
  color: var(--text-dark);
  transition: 0.3s;
}
body.dark { background: var(--bg-dark); color: var(--text-light); }

h2 { text-align: center; color: var(--orange); }

.theme-toggle {
  position: fixed; top: 14px; right: 14px;
  background: var(--orange); color: white;
  border: none; border-radius: 6px;
  padding: 8px 12px; cursor: pointer; transition: 0.3s;
}
.theme-toggle:hover { background: var(--orange-dark); }

.tabs {
  display: flex; justify-content: center; gap: 10px; margin: 20px 0;
}
.tab {
  background: #ddd; padding: 10px 18px; border-radius: 8px;
  cursor: pointer; font-weight: 600; transition: 0.3s;
}
body.dark .tab { background: #333; color: var(--text-light); }
.tab.active { background: var(--orange); color: #fff; }

.section {
  display: none; background: var(--card-light); padding: 20px;
  border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
body.dark .section {
  background: var(--card-dark);
  box-shadow: 0 2px 8px rgba(255,255,255,0.05);
}
.section.active { display: block; }

input, button, select {
  padding: 8px; margin: 6px;
  border-radius: 6px; border: 1px solid var(--border-light);
  background: inherit; color: inherit;
}
body.dark input, body.dark select {
  border: 1px solid var(--border-dark);
  background: #2b2b2b; color: var(--text-light);
}

button {
  background: var(--orange); color: white; border: none; cursor: pointer;
}
button:hover { background: var(--orange-dark); }

table { width: 100%; border-collapse: collapse; margin-top: 15px; }
th, td {
  border: 1px solid var(--border-light); padding: 8px; text-align: center;
}
body.dark th, body.dark td { border: 1px solid var(--border-dark); }
th { background: var(--orange); color: white; }

.clear-btn { background: #d9534f; }
.clear-btn:hover { background: #b52b27; }

a.back-link {
  background: #444; color: #fff; padding: 10px 18px;
  border-radius: 8px; text-decoration: none;
  display: inline-block; margin-top: 20px;
}
a.back-link:hover { background: #222; }

.remove-btn, .restock-btn {
  border-radius: 5px;
  padding: 5px 10px;
  color: white;
}
.remove-btn { background: #dc3545; }
.remove-btn:hover { background: #a71d2a; }
.restock-btn { background: #28a745; }
.restock-btn:hover { background: #1e7e34; }
</style>
</head>
<body>

<button class="theme-toggle" onclick="toggleTheme()">üåô</button>
<h2>üì¶ Business Dashboard</h2>

<div class="tabs">
  <div class="tab active" onclick="openTab('types')">üóÇ Manage Types</div>
  <div class="tab" onclick="openTab('stock')">üì¶ Current Stock</div>
  <div class="tab" onclick="openTab('sales')">üìà Sales Ledger</div>
  <div class="tab" onclick="openTab('wanting')">üõí Wanting List</div>
</div>

<!-- TYPES -->
<div id="types" class="section active">
  <h3>üóÇ Manage Item Types</h3>
  <input id="typeName" placeholder="Enter new type">
  <button onclick="addType()">Add Type</button>
  <button class="clear-btn" onclick="clearTypes()">üßπ Clear All Types</button>
  <h4>üìã Available Types</h4>
  <ul id="typeList"></ul>
</div>

<!-- STOCK -->
<div id="stock" class="section">
  <h3>üì¶ Current Stock</h3>
  <table id="stockTable">
    <thead><tr><th>Date</th><th>Type</th><th>Product</th><th>Qty</th><th>Sold</th><th>Remaining</th></tr></thead>
    <tbody></tbody>
  </table>

  <h4 style="margin-top:25px;">‚ûï Add New Stock</h4>
  <div>
    <label>Type:</label>
    <select id="ptype" onchange="updateProductList()"></select>
  </div>
  <div>
    <label>Existing Products:</label>
    <select id="pnameSelect"><option value="">-- Select Type First --</option></select>
  </div>
  <div>
    <label>Or Add New Product:</label>
    <input id="pname" placeholder="Enter new product name">
  </div>
  <input id="pqty" type="number" placeholder="Quantity">
  <input id="pdate" type="date">
  <button onclick="addStock()">Add</button>
  <button class="clear-btn" onclick="clearStock()">üßπ Clear Stock</button>
</div>

<!-- SALES -->
<div id="sales" class="section">
  <h3>üí∞ Sales Ledger</h3>
  <table id="salesTable">
    <thead><tr><th>Date</th><th>Type</th><th>Product</th><th>Qty</th><th>Price ‚Çπ</th><th>Total ‚Çπ</th></tr></thead>
    <tbody></tbody>
    <tfoot><tr><td colspan="5" style="text-align:right;font-weight:bold;">Day Total:</td><td id="dayTotal" style="font-weight:bold;color:var(--orange);">0</td></tr></tfoot>
  </table>

  <h4>Add Sale</h4>
  <input id="sdate" type="date"><select id="stype"></select>
  <input id="sname" placeholder="Product name"><input id="sqty" type="number" placeholder="Qty">
  <input id="sprice" type="number" placeholder="Price ‚Çπ">
  <button onclick="addSale()">Add Sale</button>
  <button class="clear-btn" onclick="clearSales()">üßπ Clear Sales</button>
</div>

<!-- WANTING -->
<div id="wanting" class="section">
  <h3>üõí Wanting Items</h3>
  <table id="wantTable">
    <thead><tr><th>Date</th><th>Type</th><th>Item</th><th>Restocked Qty</th><th>Actions</th></tr></thead>
    <tbody></tbody>
  </table>
  <h4>Add Wanting Item</h4>
  <input id="wdate" type="date"><select id="wtype"></select>
  <input id="witem" placeholder="Item name">
  <button onclick="addWant()">Add</button>
  <button class="clear-btn" onclick="clearWant()">üßπ Clear All</button>
</div>

<div style="text-align:center;">
  <a href="../index.html" class="back-link">‚Üê Back to Home</a>
</div>

<script>
let types = JSON.parse(localStorage.getItem('item-types')||'[]');
let stock = JSON.parse(localStorage.getItem('stock-data')||'[]');
let sales = JSON.parse(localStorage.getItem('sales-data')||'[]');
let want = JSON.parse(localStorage.getItem('wanting-data')||'[]');

(function(){
  const t = localStorage.getItem('ks-theme');
  if(t==='dark'){document.body.classList.add('dark');document.querySelector('.theme-toggle').textContent='‚òÄÔ∏è';}
})();
function toggleTheme(){
  const d=document.body.classList.toggle('dark');
  localStorage.setItem('ks-theme',d?'dark':'light');
  document.querySelector('.theme-toggle').textContent=d?'‚òÄÔ∏è':'üåô';
}

function openTab(tab){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.querySelector(`[onclick="openTab('${tab}')"]`).classList.add('active');
  document.getElementById(tab).classList.add('active');
}

function addType(){
  let name=document.getElementById('typeName').value.trim();
  if(!name)return alert("Enter type!");
  if(types.includes(name))return alert("Type exists!");
  types.push(name);
  localStorage.setItem('item-types',JSON.stringify(types));
  renderTypes();updateDropdowns();
  document.getElementById('typeName').value='';
}
function clearTypes(){
  if(confirm("Clear all types?")){
    types=[];localStorage.removeItem('item-types');
    renderTypes();updateDropdowns();
  }
}
function renderTypes(){
  document.getElementById('typeList').innerHTML = types.length
    ? types.map(t=>`<li>${t}</li>`).join('')
    : "<li>No types yet.</li>";
}
function updateDropdowns(){
  const selects=[document.getElementById('ptype'),document.getElementById('stype'),document.getElementById('wtype')];
  selects.forEach(sel=>{sel.innerHTML='<option value=\"\">Select Type</option>'+types.map(t=>`<option>${t}</option>`).join('');});
}

function addStock(){
  const type=document.getElementById('ptype').value;
  const selected=document.getElementById('pnameSelect').value;
  const name=selected || document.getElementById('pname').value.trim();
  const qty=parseInt(document.getElementById('pqty').value);
  const date=document.getElementById('pdate').value;
  if(!type||!name||!qty||!date)return alert('Fill all fields!');
  stock.push({type,name,qty,sold:0,date});
  localStorage.setItem('stock-data',JSON.stringify(stock));
  renderStock();updateProductList();
}
function renderStock(){
  const tb=document.querySelector('#stockTable tbody');
  tb.innerHTML=stock.length?stock.map(s=>{
    let remaining=s.qty-(s.sold||0);
    return `<tr><td>${s.date}</td><td>${s.type}</td><td>${s.name}</td><td>${s.qty}</td><td>${s.sold||0}</td><td>${remaining}</td></tr>`;
  }).join(''):"<tr><td colspan=6>No stock available.</td></tr>";
}
function clearStock(){if(confirm("Clear all stock?")){stock=[];localStorage.removeItem('stock-data');renderStock();}}

function updateProductList(){
  const type=document.getElementById('ptype').value;
  const pnameSelect=document.getElementById('pnameSelect');
  if(!type){pnameSelect.innerHTML='<option>-- Select Type First --</option>';return;}
  const items=stock.filter(s=>s.type===type).map(s=>s.name);
  const unique=[...new Set(items)];
  pnameSelect.innerHTML=unique.length?unique.map(p=>`<option>${p}</option>`).join(''):'<option>No products yet ‚Äî add below</option>';
}

function addSale(){
  let type=document.getElementById('stype').value;
  let product=document.getElementById('sname').value.trim();
  let qty=parseInt(document.getElementById('sqty').value);
  let price=parseFloat(document.getElementById('sprice').value);
  let date=document.getElementById('sdate').value;
  if(!type||!product||!qty||!price||!date)return alert('Fill all fields!');
  sales.push({type,product,qty,price,amount:qty*price,date});
  localStorage.setItem('sales-data',JSON.stringify(sales));
  let item=stock.find(s=>s.name.toLowerCase()===product.toLowerCase());
  if(item){item.sold=(item.sold||0)+qty;localStorage.setItem('stock-data',JSON.stringify(stock));}
  renderStock();renderSales();
}
function renderSales(){
  const tb=document.querySelector('#salesTable tbody');
  let total=0;
  tb.innerHTML=sales.length?sales.map(s=>{
    total+=s.amount;return `<tr><td>${s.date}</td><td>${s.type}</td><td>${s.product}</td><td>${s.qty}</td><td>${s.price}</td><td>${s.amount}</td></tr>`;
  }).join(''):"<tr><td colspan=6>No sales yet.</td></tr>";
  document.getElementById('dayTotal').textContent=total.toFixed(2);
}
function clearSales(){if(confirm("Clear sales?")){sales=[];localStorage.removeItem('sales-data');renderSales();}}

function addWant(){
  let type=document.getElementById('wtype').value;
  let item=document.getElementById('witem').value.trim();
  let date=document.getElementById('wdate').value;
  if(!type||!item||!date)return alert('Fill all fields!');
  want.push({type,item,date});
  localStorage.setItem('wanting-data',JSON.stringify(want));
  renderWant();
}
function renderWant(){
  const tb=document.querySelector('#wantTable tbody');
  if(!want.length){tb.innerHTML='<tr><td colspan=5>No items.</td></tr>';return;}
  tb.innerHTML=want.map((w,i)=>`<tr><td>${w.date}</td><td>${w.type}</td><td>${w.item}</td><td>-</td>
  <td><button class='restock-btn' onclick='restock(${i})'>‚úî</button> <button class='remove-btn' onclick='removeWant(${i})'>üóë</button></td></tr>`).join('');
}
function restock(i){
  let qty=prompt('Enter restocked qty:');if(!qty||isNaN(qty))return;
  const today=new Date().toISOString().split('T')[0];
  const item=want[i];
  stock.push({type:item.type,name:item.item,qty:parseInt(qty),sold:0,date:today});
  localStorage.setItem('stock-data',JSON.stringify(stock));
  want.splice(i,1);
  localStorage.setItem('wanting-data',JSON.stringify(want));
  renderStock();renderWant();
}
function removeWant(i){want.splice(i,1);localStorage.setItem('wanting-data',JSON.stringify(want));renderWant();}
function clearWant(){if(confirm('Clear wanting list?')){want=[];localStorage.removeItem('wanting-data');renderWant();}}

renderTypes();updateDropdowns();renderStock();renderSales();renderWant();
</script>
</body>
</html>
